I'll write this all up eventually. The code is pretty straight-forward though.
